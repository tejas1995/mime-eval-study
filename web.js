(()=>{"use strict";let t="https://tejassrinivasan.pythonanywhere.com/";var o=[];let i=-1,e=null,n=0,s=0;function l(t){n+=t,0==n?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),0==n?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),1==n&&($("#instructions_and_decorations").show(),$("#main_box_instructions").hide(),$("#main_box_experiment").show(),d()),$("#main_box_instructions").children(":not(input)").each(((t,o)=>{$(o).hide()})),$(`#instructions_${n}`).show()}$("#button_instructions_next").on("click",(()=>l(1))),$("#button_instructions_prev").on("click",(()=>l(-1)));const a=document.getElementById("mime_video");a?a.addEventListener("ended",(()=>{console.log("The user has watched the full video."),$("#watchvideo_instruction").hide(),$("#answer_box").show()})):console.error('Video element with ID "mime_video" not found.'),$("#answer_box").on("keyup",(()=>{""!=String($("#user_prediction").val()).trim()?$("#button_next").show():(console.log("The text box is empty."),$("#button_next").hide())})),$("#button_next").on("click",(()=>{if(-1!=i){let o={question_i:i,user_answer:$("#user_prediction").val()};o.question=e,o.count_exited_page=s,async function(o){o.url_data=globalThis.url_data,console.log("Data"),"study_id"in o.url_data||(o.url_data.study_id="demo_study"),"prolific_id"in o.url_data||(o.url_data.prolific_id="demo_user"),"session_id"in o.url_data||(o.url_data.session_id="demo_session"),o.url_data.queue_id=globalThis.uid,console.log("logged",o),console.log("Logging to",t+"log");try{let i=await $.ajax(t+"log",{data:JSON.stringify({project:"vlm-rationales-study/"+o.url_data.study_id,uid:globalThis.uid.replace("/","_")+"_"+o.url_data.prolific_id,payload:JSON.stringify(o)}),type:"POST",contentType:"application/json"});return await async function(){return new Promise((t=>setTimeout(t,2e3)))}(),i}catch(t){console.log(t)}}(o),s=0}d()}));let r=null;function d(){if(r&&(clearInterval(r),r=null),i+=1,i>=o.length)return $("#main_box_experiment").hide(),$("#reward_box").show(),void $("#main_box_end").show();e=o[i],console.log(e),$("#video").attr("src",e.video_url),$("#video").show(),$("#watchvideo_instruction").show(),$("#answer_box").hide(),$("#button_next").hide(),$("#button_quit").hide(),$("#progress").text(`Progress: ${i+1} / ${o.length}`)}document.onvisibilitychange=()=>{document.hidden?(console.log("Window lost focus."),null!==r&&(clearInterval(r),r=null)):console.log("Window regained focus.")};const u=new URLSearchParams(window.location.search),_=u.get("start"),c=u.get("uid");if(globalThis.url_data=function(t){const o={};for(const[i,e]of t)o[i]=e;return o}(u.entries()),null==globalThis.url_data.study_id&&(globalThis.url_data.study_id="demo_study"),null==globalThis.url_data.prolific_id&&(globalThis.url_data.prolific_id="demo_user"),null==globalThis.url_data.session_id&&(globalThis.url_data.session_id="demo_session"),null!=c){if(globalThis.uid=c,"prolific_random"==globalThis.uid){let t=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${u.get("prolific_queue_name")}/${t}`}}else{let t=null;for(;null==t;)t=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=t}globalThis.url_data.session_id.startsWith("demo"),console.log("Running with UID",globalThis.uid),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((t=>{console.log("Invalid user id."),console.log(globalThis.uid),window.location.reload()})).then((t=>{o=t,null!=_&&(i=parseInt(_)-1,console.log("Starting from",i)),l(0),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()})),console.log("Starting session with UID:",globalThis.uid);let h=!1;document.onvisibilitychange=()=>{h||(s+=1,h=!0,globalThis.uid.startsWith("demo")||alert("Please don't leave the page. If you do so again, we may restrict paying you."),h=!1)}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQUdzQixFQUFVTSxJQUFJLDBCQUEwQk0sRyxNQUk3RCxDQUNILElBQUlLLEVBQWlCLEtBQ3JCLEtBQW9CLE1BQWJBLEdBQ0hBLEVBQVlDLE9BQU8sc0hBRXZCMUMsV0FBV0UsSUFBTXVDLEMsQ0FNVnpDLFdBQVdDLFNBQXFCLFdBQUUwQyxXQUFXLFFBSXhEbEQsUUFBUUMsSUFBSSxtQkFBb0JNLFdBQVdFLEtENVBwQ0gsaUJBS0gsYUFIbUJ0QixFQUFFbUUsUUFDakIsZ0JBQWdCNUMsV0FBV0UsY0FBYzJDLEtBQUtDLFFBR3RELENDdVBBQyxHQUFZQyxPQUFPQyxJQUVmeEQsUUFBUUMsSUFBSSxvQkFDWkQsUUFBUUMsSUFBSU0sV0FBV0UsS0FDdkJ3QixPQUFPQyxTQUFTdUIsUUFBUSxJQUUxQkMsTUFBTUMsSUFDSmxGLEVBQU9rRixFQUNjLE1BQWpCdkIsSUFDQTFELEVBQWFrRixTQUFTeEIsR0FBaUIsRUFDdkNwQyxRQUFRQyxJQUFJLGdCQUFpQnZCLElBR2pDSSxFQUFrQixHQUNsQkUsRUFBRSwwQkFBMEJHLE9BQzVCSCxFQUFFLGlDQUFpQ0ssTUFBTSxJQTZCN0NXLFFBQVFDLElBQUksNkJBQThCTSxXQUFXRSxLQUVyRCxJQUFJb0QsR0FBZSxFQUNuQmhFLFNBQVNnQyxtQkFBcUIsS0FDckJnQyxJQUNEaEYsR0FBcUIsRUFDckJnRixHQUFlLEVBQ1R0RCxXQUFXRSxJQUFLeUMsV0FBVyxTQUU5QlksTUFBTSxnRkFFVEQsR0FBZSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2Nvbm5lY3Rvci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgREVWTU9ERSB9IGZyb20gJy4vZ2xvYmFscydcbmltcG9ydCB7IE1PQ0tNT0RFIH0gZnJvbSAnLi9tYWluJ1xuXG5sZXQgU0VSVkVSX0xPR19ST09UID0gREVWTU9ERSA/IFwiaHR0cDovLzEyNy4wLjAuMTo1MDAwL1wiIDogXCJodHRwczovL3RlamFzc3Jpbml2YXNhbi5weXRob25hbnl3aGVyZS5jb20vXCJcblxuYXN5bmMgZnVuY3Rpb24gc2xlZXAobXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZF9kYXRhKCk6IFByb21pc2U8YW55PiB7XG4gICAgLy8gaW5jbHVkZSB0aW1lc3RhbXAgc28gdGhhdCB0aGluZ3MgZG9uJ3QgZ2V0IGNhY2hlZFxuICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmdldEpTT04oXG4gICAgICAgIGBiYWtlZF9xdWV1ZXMvJHtnbG9iYWxUaGlzLnVpZH0uanNvbj90PSR7RGF0ZS5ub3coKX1gLFxuICAgIClcbiAgICByZXR1cm4gcmVzdWx0XG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nX2RhdGEoZGF0YSk6IFByb21pc2U8YW55PiB7XG4gICAgLy9pZiAoTU9DS01PREUpIHtcbiAgICAvLyAgICBjb25zb2xlLmxvZyhcImxvZ2dlZCAobW9jaylcIiwgZGF0YSlcbiAgICAvLyAgICByZXR1cm5cbiAgICAvL31cbiAgICBcbiAgICBkYXRhW1widXJsX2RhdGFcIl0gPSBnbG9iYWxUaGlzLnVybF9kYXRhXG4gICAgY29uc29sZS5sb2coXCJEYXRhXCIpXG4gICAgaWYgKCEoXCJzdHVkeV9pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XG4gICAgICAgIGRhdGFbJ3VybF9kYXRhJ11bXCJzdHVkeV9pZFwiXSA9IFwiZGVtb19zdHVkeVwiXG4gICAgfVxuICAgIGlmICghKFwicHJvbGlmaWNfaWRcIiBpbiBkYXRhWyd1cmxfZGF0YSddKSkge1xuICAgICAgICBkYXRhWyd1cmxfZGF0YSddW1wicHJvbGlmaWNfaWRcIl0gPSBcImRlbW9fdXNlclwiXG4gICAgfVxuICAgIGlmICghKFwic2Vzc2lvbl9pZFwiIGluIGRhdGFbJ3VybF9kYXRhJ10pKSB7XG4gICAgICAgIGRhdGFbJ3VybF9kYXRhJ11bXCJzZXNzaW9uX2lkXCJdID0gXCJkZW1vX3Nlc3Npb25cIlxuICAgIH1cbiAgICBkYXRhW1widXJsX2RhdGFcIl1bXCJxdWV1ZV9pZFwiXSA9IGdsb2JhbFRoaXMudWlkXG4gICAgY29uc29sZS5sb2coXCJsb2dnZWRcIiwgZGF0YSlcbiAgICBjb25zb2xlLmxvZyhcIkxvZ2dpbmcgdG9cIiwgU0VSVkVSX0xPR19ST09UICsgXCJsb2dcIilcblxuICAgIHRyeSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmFqYXgoXG4gICAgICAgICAgICBTRVJWRVJfTE9HX1JPT1QgKyBcImxvZ1wiLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdDogXCJ2bG0tcmF0aW9uYWxlcy1zdHVkeS9cIitkYXRhWyd1cmxfZGF0YSddWydzdHVkeV9pZCddLFxuICAgICAgICAgICAgICAgICAgICB1aWQ6IGdsb2JhbFRoaXMudWlkLnJlcGxhY2UoXCIvXCIsIFwiX1wiKSArIFwiX1wiICsgZGF0YVsndXJsX2RhdGEnXVsncHJvbGlmaWNfaWQnXSxcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZDogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgICAgYXdhaXQgc2xlZXAoMjAwMCk7XG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUpXG4gICAgfVxufSIsImltcG9ydCB7IERFVk1PREUsIFJFV0FSRF9DT1JSRUNULCBQRU5BTFRZX0lOQ09SUkVDVCwgRU5BQkxFX1RJTUVSIH0gZnJvbSBcIi4vZ2xvYmFsc1wiXG5leHBvcnQgdmFyIFVJRDogc3RyaW5nXG5leHBvcnQgdmFyIE1PQ0tNT0RFOiBib29sZWFuID0gZmFsc2VcbmltcG9ydCB7IGxvYWRfZGF0YSwgbG9nX2RhdGEgfSBmcm9tICcuL2Nvbm5lY3RvcidcbmltcG9ydCB7IHBhcmFtc1RvT2JqZWN0IH0gZnJvbSBcIi4vdXRpbHNcIlxuXG52YXIgZGF0YTogYW55W10gPSBbXVxubGV0IHF1ZXN0aW9uX2kgPSAtMVxubGV0IHF1ZXN0aW9uOiBhbnkgPSBudWxsXG5cblxubGV0IGJhbGFuY2UgPSAwXG5cbmxldCBpbnN0cnVjdGlvbl9pOiBudW1iZXIgPSAwXG5sZXQgY291bnRfZXhpdGVkX3BhZ2U6IG51bWJlciA9IDBcblxuZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgbWVzc2FnZSkge1xuICAgIGlmICghY29uZGl0aW9uKSB7XG4gICAgICAgIHRocm93IG1lc3NhZ2UgfHwgXCJBc3NlcnRpb24gZmFpbGVkXCI7XG4gICAgfVxufVxuXG5cbmZ1bmN0aW9uIG5leHRfaW5zdHJ1Y3Rpb25zKGluY3JlbWVudDogbnVtYmVyKSB7XG4gICAgaW5zdHJ1Y3Rpb25faSArPSBpbmNyZW1lbnRcblxuICAgIGlmIChpbnN0cnVjdGlvbl9pID09IDApIHtcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX3ByZXZcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgIH0gZWxzZSB7XG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgIH1cbiAgICBpZiAoaW5zdHJ1Y3Rpb25faSA9PSAwKSB7XG4gICAgICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5zaG93KClcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikudmFsKFwiU3RhcnQgc3R1ZHlcIilcbiAgICB9IGVsc2Uge1xuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuaGlkZSgpXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnZhbChcIk5leHRcIilcbiAgICB9XG4gICAgaWYgKGluc3RydWN0aW9uX2kgPT0gMSkge1xuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuc2hvdygpXG4gICAgICAgICQoXCIjbWFpbl9ib3hfaW5zdHJ1Y3Rpb25zXCIpLmhpZGUoKVxuICAgICAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuc2hvdygpXG4gICAgICAgIG5leHRfcXVlc3Rpb24oKVxuICAgIH1cblxuICAgICQoXCIjbWFpbl9ib3hfaW5zdHJ1Y3Rpb25zXCIpLmNoaWxkcmVuKFwiOm5vdChpbnB1dClcIikuZWFjaCgoXywgZWwpID0+IHtcbiAgICAgICAgJChlbCkuaGlkZSgpXG4gICAgfSlcbiAgICAkKGAjaW5zdHJ1Y3Rpb25zXyR7aW5zdHJ1Y3Rpb25faX1gKS5zaG93KClcbn1cbiQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4gbmV4dF9pbnN0cnVjdGlvbnMoKzEpKVxuJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX3ByZXZcIikub24oXCJjbGlja1wiLCAoKSA9PiBuZXh0X2luc3RydWN0aW9ucygtMSkpXG5cbi8vIEFkZCBsaXN0ZW5lciB0byBlbnN1cmUgdGhlIHZpZGVvIGhhcyBiZWVuIHdhdGNoZWRcbmNvbnN0IHZpZGVvRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaW1lX3ZpZGVvJyk7XG5cbmlmICh2aWRlb0VsZW1lbnQpIHtcbiAgICAvLyBBZGQgYW4gZXZlbnQgbGlzdGVuZXIgZm9yIHRoZSAnZW5kZWQnIGV2ZW50XG4gICAgdmlkZW9FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2VuZGVkJywgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnVGhlIHVzZXIgaGFzIHdhdGNoZWQgdGhlIGZ1bGwgdmlkZW8uJyk7XG4gICAgICAgIC8vIFlvdSBjYW4gYWRkIGFkZGl0aW9uYWwgYWN0aW9ucyBoZXJlLCBzdWNoIGFzIG1hcmtpbmcgdGhlIHZpZGVvIGFzIHdhdGNoZWRcbiAgICAgICAgJChcIiN3YXRjaHZpZGVvX2luc3RydWN0aW9uXCIpLmhpZGUoKVxuICAgICAgICAkKFwiI2Fuc3dlcl9ib3hcIikuc2hvdygpXG4gICAgfSk7XG59IGVsc2Uge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1ZpZGVvIGVsZW1lbnQgd2l0aCBJRCBcIm1pbWVfdmlkZW9cIiBub3QgZm91bmQuJyk7XG59XG5cblxuJCgnI2Fuc3dlcl9ib3gnKS5vbigna2V5dXAnLCAoKSA9PiB7XG4gICAgbGV0IHVzZXJfcHJlZGljdGlvbiA9IFN0cmluZygkKCcjdXNlcl9wcmVkaWN0aW9uJykudmFsKCkpLnRyaW0oKVxuICAgIGlmICh1c2VyX3ByZWRpY3Rpb24gIT0gJycpIHtcbiAgICAgICAgJChcIiNidXR0b25fbmV4dFwiKS5zaG93KClcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygnVGhlIHRleHQgYm94IGlzIGVtcHR5LicpO1xuICAgICAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLmhpZGUoKVxuICAgIH1cbn0pO1xuXG4kKFwiI2J1dHRvbl9uZXh0XCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xuXG4gICAgLy8gVXBkYXRlIHRoZSB1c2VyIGJhbGFuY2VcbiAgICBpZiAocXVlc3Rpb25faSAhPSAtMSkge1xuICAgICAgICBsZXQgbG9nZ2VkX2RhdGEgPSB7XG4gICAgICAgICAgICBcInF1ZXN0aW9uX2lcIjogcXVlc3Rpb25faSxcbiAgICAgICAgICAgIFwidXNlcl9hbnN3ZXJcIjogJChcIiN1c2VyX3ByZWRpY3Rpb25cIikudmFsKCksXG4gICAgICAgIH1cbiAgICAgICAgbG9nZ2VkX2RhdGFbJ3F1ZXN0aW9uJ10gPSBxdWVzdGlvblxuICAgICAgICBsb2dnZWRfZGF0YVsnY291bnRfZXhpdGVkX3BhZ2UnXSA9IGNvdW50X2V4aXRlZF9wYWdlXG4gICAgICAgIGxvZ19kYXRhKGxvZ2dlZF9kYXRhKVxuICAgICAgICBjb3VudF9leGl0ZWRfcGFnZSA9IDBcbiAgICB9XG4gICAgXG5cbiAgICBuZXh0X3F1ZXN0aW9uKClcbn0pO1xuXG5cbi8vIFRvIGVuc3VyZSBiYWxhbmNlIGlzIG5vbi1uZWdhdGl2ZVxuZnVuY3Rpb24gZmluYWxpemVfYmFsYW5jZSgpIHtcbiAgICBiYWxhbmNlID0gTWF0aC5tYXgoMCwgYmFsYW5jZSk7XG4gICAgcmV0dXJuIGJhbGFuY2U7XG59XG5cbmxldCBhY3RpdmVUaW1lcjogUmV0dXJuVHlwZTx0eXBlb2Ygc2V0SW50ZXJ2YWw+IHwgbnVsbCA9IG51bGw7IC8vIFRpbWVyIGludGVydmFsXG5cbmZ1bmN0aW9uIHN0YXJ0VGltZXIoZHVyYXRpb24sIHN0ZXBEaXYsIGJ1dHRvbnMsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFFTkFCTEVfVElNRVIpIHtcbiAgICAgICAgLy8gSWYgdGhlIHRpbWVyIGlzIGRpc2FibGVkLCBlbmFibGUgdGhlIGJ1dHRvbnMgaW1tZWRpYXRlbHlcbiAgICAgICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIikpO1xuICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBDbGVhciBhbnkgZXhpc3RpbmcgdGltZXIgdG8gcHJldmVudCBtdWx0aXBsZSBpbnRlcnZhbHNcbiAgICBpZiAoYWN0aXZlVGltZXIpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChhY3RpdmVUaW1lcik7XG4gICAgICAgIGFjdGl2ZVRpbWVyID0gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBEaXNhYmxlIGJ1dHRvbnNcbiAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcInRydWVcIikpO1xuICAgIFxuICAgIC8vIFNob3cgdGltZXIgdmlzdWFsbHlcbiAgICBsZXQgdGltZXJEaXNwbGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGltZXJEaXNwbGF5LmlkID0gYHRpbWVyXyR7c3RlcERpdi5pZH1gO1xuICAgIHRpbWVyRGlzcGxheS5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuICAgIHRpbWVyRGlzcGxheS5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7XG4gICAgc3RlcERpdi5hcHBlbmRDaGlsZCh0aW1lckRpc3BsYXkpO1xuXG4gICAgbGV0IHJlbWFpbmluZ1RpbWUgPSBkdXJhdGlvbjtcblxuICAgIC8vIEluaXRpYWwgZGlzcGxheVxuICAgIHRpbWVyRGlzcGxheS50ZXh0Q29udGVudCA9IGBQbGVhc2Ugd2FpdCAke3JlbWFpbmluZ1RpbWV9IHNlY29uZChzKSBiZWZvcmUgbWFraW5nIHlvdXIgc2VsZWN0aW9uLmA7XG5cbiAgICBhY3RpdmVUaW1lciA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgcmVtYWluaW5nVGltZS0tO1xuICAgICAgICBpZiAocmVtYWluaW5nVGltZSA+PSAwKSB7XG4gICAgICAgICAgICB0aW1lckRpc3BsYXkudGV4dENvbnRlbnQgPSBgUGxlYXNlIHdhaXQgJHtyZW1haW5pbmdUaW1lfSBzZWNvbmQocykgYmVmb3JlIG1ha2luZyB5b3VyIHNlbGVjdGlvbi5gO1xuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICBpZiAoYWN0aXZlVGltZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGFjdGl2ZVRpbWVyKTsgLy8gU3RvcCB0aGUgdGltZXJcbiAgICAgICAgICAgICAgICBhY3RpdmVUaW1lciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhY3RpdmVUaW1lciA9IG51bGw7XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aW1lciBkaXNwbGF5XG4gICAgICAgICAgICBzdGVwRGl2LnJlbW92ZUNoaWxkKHRpbWVyRGlzcGxheSk7XG5cbiAgICAgICAgICAgIC8vIEVuYWJsZSBidXR0b25zXG4gICAgICAgICAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSk7XG5cbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgIH0sIDEwMDApO1xufVxuXG4vLyBXaGVuIHRoZSB1c2VyIHN3aXRjaGVzIHRhYnMgb3IgbWluaW1pemVzIHRoZSB3aW5kb3csIHBhdXNlIHRoZSB0aW1lclxuZG9jdW1lbnQub252aXNpYmlsaXR5Y2hhbmdlID0gKCkgPT4ge1xuICAgIGlmIChkb2N1bWVudC5oaWRkZW4pIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJXaW5kb3cgbG9zdCBmb2N1cy5cIik7XG4gICAgICAgIGlmIChhY3RpdmVUaW1lciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhY3RpdmVUaW1lcik7IC8vIFBhdXNlIHRoZSB0aW1lclxuICAgICAgICAgICAgYWN0aXZlVGltZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gSGFuZGxlIGxvZ2ljIHdoZW4gdGhlIHVzZXIgcmV0dXJuc1xuICAgICAgICBjb25zb2xlLmxvZyhcIldpbmRvdyByZWdhaW5lZCBmb2N1cy5cIik7XG4gICAgfVxufTtcblxuXG5cbmZ1bmN0aW9uIG5leHRfcXVlc3Rpb24oKSB7XG4gICAgLy8gUmVzZXQgdGltZXJzIGFuZCBzdGF0ZVxuICAgIGlmIChhY3RpdmVUaW1lcikge1xuICAgICAgICBjbGVhckludGVydmFsKGFjdGl2ZVRpbWVyKTtcbiAgICAgICAgYWN0aXZlVGltZXIgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIHJlc3RvcmUgcHJldmlvdXMgc3RhdGUgb2YgVUlcblxuICAgIC8vJChcIiNyYW5nZV92YWxcIikudmFsKHVzZXJfdHJ1c3QpXG5cbiAgICBxdWVzdGlvbl9pICs9IDFcbiAgICBpZiAocXVlc3Rpb25faSA+PSBkYXRhLmxlbmd0aCkge1xuICAgICAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuaGlkZSgpXG4gICAgICAgICQoJyNyZXdhcmRfYm94Jykuc2hvdygpXG4gICAgICAgICQoXCIjbWFpbl9ib3hfZW5kXCIpLnNob3coKVxuICAgICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBxdWVzdGlvbiA9IGRhdGFbcXVlc3Rpb25faV1cbiAgICBjb25zb2xlLmxvZyhxdWVzdGlvbilcblxuICAgICQoXCIjdmlkZW9cIikuYXR0cihcInNyY1wiLCBxdWVzdGlvbltcInZpZGVvX3VybFwiXSlcbiAgICAkKFwiI3ZpZGVvXCIpLnNob3coKVxuICAgICQoXCIjd2F0Y2h2aWRlb19pbnN0cnVjdGlvblwiKS5zaG93KClcbiAgICAkKCcjYW5zd2VyX2JveCcpLmhpZGUoKVxuICAgICQoXCIjYnV0dG9uX25leHRcIikuaGlkZSgpXG4gICAgJCgnI2J1dHRvbl9xdWl0JykuaGlkZSgpXG5cblxuICAgIC8vIHNldCBiZXQgdmFsdWUgcmF0aW9cbiAgICAvL2lmKHF1ZXN0aW9uLmhhc093blByb3BlcnR5KFwicmV3YXJkX3JhdGlvXCIpKSB7XG4gICAgLy8gICAgbGV0IFtyYXRpbzEsIHJhdGlvMl0gPSBxdWVzdGlvbltcInJld2FyZF9yYXRpb1wiXVxuICAgIC8vICAgIHJhdGlvMSA9IE51bWJlcihyYXRpbzEpXG4gICAgLy8gICAgcmF0aW8yID0gTnVtYmVyKHJhdGlvMilcbiAgICAvLyAgICBiZXRfdmFsX3JhdGlvID0gcmF0aW8xL3JhdGlvMlxuICAgIC8vfSBlbHNlIHtcbiAgICAvLyAgICBiZXRfdmFsX3JhdGlvID0gMVxuICAgIC8vfVxuXG4gICAgLy90aW1lX3F1ZXN0aW9uX3N0YXJ0ID0gRGF0ZS5ub3coKVxuICAgICQoXCIjcHJvZ3Jlc3NcIikudGV4dChgUHJvZ3Jlc3M6ICR7cXVlc3Rpb25faSArIDF9IC8gJHtkYXRhLmxlbmd0aH1gKVxuXG59XG5cblxuXG4vLyBnZXQgdXNlciBpZCBhbmQgbG9hZCBxdWV1ZVxuLy8gdHJ5IHRvIHNlZSBpZiBzdGFydCBvdmVycmlkZSB3YXMgcGFzc2VkXG5jb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuY29uc3Qgc3RhcnRPdmVycmlkZSA9IHVybFBhcmFtcy5nZXQoJ3N0YXJ0Jyk7XG5jb25zdCBVSURGcm9tVVJMID0gdXJsUGFyYW1zLmdldChcInVpZFwiKVxuZ2xvYmFsVGhpcy51cmxfZGF0YSA9IHBhcmFtc1RvT2JqZWN0KHVybFBhcmFtcy5lbnRyaWVzKCkpXG5cbmlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydzdHVkeV9pZCddID09IG51bGwpIHtcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydzdHVkeV9pZCddID0gXCJkZW1vX3N0dWR5XCJcbn1cbmlmIChnbG9iYWxUaGlzLnVybF9kYXRhWydwcm9saWZpY19pZCddID09IG51bGwpIHtcbiAgICBnbG9iYWxUaGlzLnVybF9kYXRhWydwcm9saWZpY19pZCddID0gXCJkZW1vX3VzZXJcIlxufVxuaWYgKGdsb2JhbFRoaXMudXJsX2RhdGFbJ3Nlc3Npb25faWQnXSA9PSBudWxsKSB7XG4gICAgZ2xvYmFsVGhpcy51cmxfZGF0YVsnc2Vzc2lvbl9pZCddID0gXCJkZW1vX3Nlc3Npb25cIlxufVxuXG5pZiAoVUlERnJvbVVSTCAhPSBudWxsKSB7XG4gICAgZ2xvYmFsVGhpcy51aWQgPSBVSURGcm9tVVJMIGFzIHN0cmluZ1xuICAgIGlmIChnbG9iYWxUaGlzLnVpZCA9PSBcInByb2xpZmljX3JhbmRvbVwiKSB7XG4gICAgICAgIGxldCBxdWV1ZV9pZCA9IGAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKX1gLnBhZFN0YXJ0KDMsIFwiMFwiKVxuICAgICAgICBnbG9iYWxUaGlzLnVpZCA9IGAke3VybFBhcmFtcy5nZXQoXCJwcm9saWZpY19xdWV1ZV9uYW1lXCIpfS8ke3F1ZXVlX2lkfWBcbiAgICB9XG59IGVsc2UgaWYgKERFVk1PREUpIHtcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFwiZGVtb1wiXG59IGVsc2Uge1xuICAgIGxldCBVSURfbWF5YmU6IGFueSA9IG51bGxcbiAgICB3aGlsZSAoVUlEX21heWJlID09IG51bGwpIHtcbiAgICAgICAgVUlEX21heWJlID0gcHJvbXB0KFwiRW50ZXIgeW91ciB1c2VyIGlkLiBQbGVhc2UgZ2V0IGluIHRvdWNoIGlmIHlvdSB3ZXJlIG5vdCBhc3NpZ25lZCBhbiBpZCBidXQgd2lzaCB0byBwYXJ0aWNpcGF0ZSBpbiB0aGlzIGV4cGVyaW1lbnQuXCIpXG4gICAgfVxuICAgIGdsb2JhbFRoaXMudWlkID0gVUlEX21heWJlIVxufVxuXG4vLyB2ZXJzaW9uIGZvciBwYXBlclxuaWYgKERFVk1PREUpIHtcbiAgICBNT0NLTU9ERSA9IHRydWVcbn0gZWxzZSBpZiAoZ2xvYmFsVGhpcy51cmxfZGF0YVsnc2Vzc2lvbl9pZCddLnN0YXJ0c1dpdGgoXCJkZW1vXCIpKSB7XG4gICAgTU9DS01PREUgPSB0cnVlXG59XG5cbmNvbnNvbGUubG9nKFwiUnVubmluZyB3aXRoIFVJRFwiLCBnbG9iYWxUaGlzLnVpZClcbmxvYWRfZGF0YSgpLmNhdGNoKChfZXJyb3IpID0+IHtcbiAgICAvL2FsZXJ0KFwiSW52YWxpZCB1c2VyIGlkLlwiKVxuICAgIGNvbnNvbGUubG9nKFwiSW52YWxpZCB1c2VyIGlkLlwiKVxuICAgIGNvbnNvbGUubG9nKGdsb2JhbFRoaXMudWlkISlcbiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbn1cbikudGhlbigobmV3X2RhdGEpID0+IHtcbiAgICBkYXRhID0gbmV3X2RhdGFcbiAgICBpZiAoc3RhcnRPdmVycmlkZSAhPSBudWxsKSB7XG4gICAgICAgIHF1ZXN0aW9uX2kgPSBwYXJzZUludChzdGFydE92ZXJyaWRlKSAtIDFcbiAgICAgICAgY29uc29sZS5sb2coXCJTdGFydGluZyBmcm9tXCIsIHF1ZXN0aW9uX2kpXG4gICAgfVxuICAgIC8vIG5leHRfcXVlc3Rpb24oKVxuICAgIG5leHRfaW5zdHJ1Y3Rpb25zKDApXG4gICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuc2hvdygpXG4gICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLmhpZGUoKVxufSlcblxuLy8gLy8gRHluYW1pY2FsbHkgbG9hZCBkYXRhc2V0IGJhc2VkIG9uIERBVEFTRVRcbi8vIGZldGNoKGAuL2Jha2VkX3F1ZXVlcy8ke0RBVEFTRVR9YClcbi8vICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4vLyAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbi8vICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBsb2FkIGRhdGFzZXQuXCIpO1xuLy8gICAgICAgICB9XG4vLyAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4vLyAgICAgfSlcbi8vICAgICAudGhlbigobmV3X2RhdGEpID0+IHtcbi8vICAgICAgICAgZGF0YSA9IG5ld19kYXRhO1xuLy8gICAgICAgICBpZiAoc3RhcnRPdmVycmlkZSAhPSBudWxsKSB7XG4vLyAgICAgICAgICAgICBxdWVzdGlvbl9pID0gcGFyc2VJbnQoc3RhcnRPdmVycmlkZSkgLSAxO1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coXCJTdGFydGluZyBmcm9tXCIsIHF1ZXN0aW9uX2kpO1xuLy8gICAgICAgICB9XG4vLyAgICAgICAgIG5leHRfaW5zdHJ1Y3Rpb25zKDApO1xuLy8gICAgICAgICB1cGRhdGVSZXdhcmRJbnN0cnVjdGlvbnMoKTtcbi8vICAgICAgICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuc2hvdygpO1xuLy8gICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuaGlkZSgpO1xuLy8gICAgIH0pXG4vLyAgICAgLmNhdGNoKChfZXJyb3IpID0+IHtcbi8vICAgICAgICAgY29uc29sZS5lcnJvcihcIkludmFsaWQgdXNlciBpZCBvciBkYXRhc2V0IGxvYWRpbmcgZmFpbGVkLlwiKTtcbi8vICAgICAgICAgY29uc29sZS5sb2coZ2xvYmFsVGhpcy51aWQhKTtcbi8vICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuLy8gICAgIH0pO1xuXG5cbmNvbnNvbGUubG9nKFwiU3RhcnRpbmcgc2Vzc2lvbiB3aXRoIFVJRDpcIiwgZ2xvYmFsVGhpcy51aWQhKVxuXG5sZXQgYWxlcnRfYWN0aXZlID0gZmFsc2VcbmRvY3VtZW50Lm9udmlzaWJpbGl0eWNoYW5nZSA9ICgpID0+IHtcbiAgICBpZiAoIWFsZXJ0X2FjdGl2ZSkge1xuICAgICAgICBjb3VudF9leGl0ZWRfcGFnZSArPSAxXG4gICAgICAgIGFsZXJ0X2FjdGl2ZSA9IHRydWVcbiAgICAgICAgaWYgKCEoZ2xvYmFsVGhpcy51aWQhLnN0YXJ0c1dpdGgoXCJkZW1vXCIpKSkge1xuICAgICAgICAgICAgLy8gcGF1c2UgdGhlIHRpbWVyXG4gICAgICAgICAgIGFsZXJ0KFwiUGxlYXNlIGRvbid0IGxlYXZlIHRoZSBwYWdlLiBJZiB5b3UgZG8gc28gYWdhaW4sIHdlIG1heSByZXN0cmljdCBwYXlpbmcgeW91LlwiKVxuICAgICAgICB9XG4gICAgICAgIGFsZXJ0X2FjdGl2ZSA9IGZhbHNlXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICAgIC8vY29udGludWUgdGhlIHRpbWVyP1xuICAgIH1cbn0iLCJmdW5jdGlvbiBwYXJhbXNUb09iamVjdChlbnRyaWVzKSB7XG4gIGNvbnN0IHJlc3VsdCA9IHt9XG4gIC8vIGVhY2ggJ2VudHJ5JyBpcyBhIFtrZXksIHZhbHVlXSB0dXBwbGVcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgZW50cmllcykge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IHsgcGFyYW1zVG9PYmplY3QgfSJdLCJuYW1lcyI6WyJTRVJWRVJfTE9HX1JPT1QiLCJkYXRhIiwicXVlc3Rpb25faSIsInF1ZXN0aW9uIiwiaW5zdHJ1Y3Rpb25faSIsImNvdW50X2V4aXRlZF9wYWdlIiwibmV4dF9pbnN0cnVjdGlvbnMiLCJpbmNyZW1lbnQiLCIkIiwiYXR0ciIsInJlbW92ZUF0dHIiLCJzaG93IiwidmFsIiwiaGlkZSIsIm5leHRfcXVlc3Rpb24iLCJjaGlsZHJlbiIsImVhY2giLCJfIiwiZWwiLCJvbiIsInZpZGVvRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJhZGRFdmVudExpc3RlbmVyIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwiU3RyaW5nIiwidHJpbSIsImxvZ2dlZF9kYXRhIiwiYXN5bmMiLCJnbG9iYWxUaGlzIiwidXJsX2RhdGEiLCJ1aWQiLCJyZXN1bHQiLCJhamF4IiwiSlNPTiIsInN0cmluZ2lmeSIsInByb2plY3QiLCJyZXBsYWNlIiwicGF5bG9hZCIsInR5cGUiLCJjb250ZW50VHlwZSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInNsZWVwIiwiZSIsImxvZ19kYXRhIiwiYWN0aXZlVGltZXIiLCJjbGVhckludGVydmFsIiwibGVuZ3RoIiwidGV4dCIsIm9udmlzaWJpbGl0eWNoYW5nZSIsImhpZGRlbiIsInVybFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsIndpbmRvdyIsImxvY2F0aW9uIiwic2VhcmNoIiwic3RhcnRPdmVycmlkZSIsImdldCIsIlVJREZyb21VUkwiLCJlbnRyaWVzIiwia2V5IiwidmFsdWUiLCJwYXJhbXNUb09iamVjdCIsInF1ZXVlX2lkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicGFkU3RhcnQiLCJVSURfbWF5YmUiLCJwcm9tcHQiLCJzdGFydHNXaXRoIiwiZ2V0SlNPTiIsIkRhdGUiLCJub3ciLCJsb2FkX2RhdGEiLCJjYXRjaCIsIl9lcnJvciIsInJlbG9hZCIsInRoZW4iLCJuZXdfZGF0YSIsInBhcnNlSW50IiwiYWxlcnRfYWN0aXZlIiwiYWxlcnQiXSwic291cmNlUm9vdCI6IiJ9